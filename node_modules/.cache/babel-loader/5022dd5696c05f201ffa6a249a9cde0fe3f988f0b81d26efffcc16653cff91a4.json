{"ast":null,"code":"import axios from \"axios\";\nimport * as turf from \"@turf/turf\";\nexport const mapCheckModule = {\n  state: () => ({\n    deliveryPossible: false,\n    polygonCoord1: \"\",\n    polygonCoord2: \"\",\n    polygonCoord3: \"\"\n  }),\n  mutations: {\n    setDeliveryPossible(state, deliveryPossible) {\n      state.deliveryPossible = deliveryPossible;\n    },\n    updatePolygon1(state, polygonCoord1) {\n      state.polygonCoord1 = polygonCoord1;\n    },\n    updatePolygon2(state, polygonCoord2) {\n      state.polygonCoord2 = polygonCoord2;\n    },\n    updatePolygon3(state, polygonCoord3) {\n      state.polygonCoord3 = polygonCoord3;\n    }\n  },\n  actions: {\n    async checkAddress({\n      state,\n      commit\n    }) {\n      try {\n        console.log(polygonCoord1, polygonCoord2, polygonCoord3, lat, long);\n        var polygon1 = turf.polygon([polygonCoord1]);\n        var polygon2 = turf.polygon([polygonCoord2]);\n        var polygon3 = turf.polygon([polygonCoord3]);\n\n        // Создаем точки\n        var points = turf.points([[lat, long]]);\n\n        // Проверяем точки внутри полигона\n        var pointsWithin1 = turf.pointsWithinPolygon(points, polygon1);\n        var pointsWithin2 = turf.pointsWithinPolygon(points, polygon2);\n        var pointsWithin3 = turf.pointsWithinPolygon(points, polygon3);\n        if (pointsWithin1.features.length > 0 || pointsWithin2.features.length > 0) {\n          commit('setDeliveryPossible', true);\n        } else {\n          commit('setDeliveryPossible', false);\n        }\n        const {\n          data\n        } = await axios.get(`https://geocode-maps.yandex.ru/1.x/?apikey=37720b8b-dc03-4346-b6a4-3ae3458e9af6&geocode=${lat},${long}&format=json&lang=ru_RU`);\n        const path = data.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData;\n        const filteredArray = path.Address.Components.filter(item => [\"street\", \"metro\", \"district\", \"area\", \"province\", \"railway_station\", \"station\", \"vegetation\", \"other\", \"house\"].includes(item.kind));\n        const names = filteredArray.map(item => item.name).join(\", \");\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    updatePolygonAction({\n      commit\n    }, polygonCoord1, polygonCoord2, polygonCoord3) {\n      commit('updatePolygon1', polygonCoord1);\n      commit('updatePolygon2', polygonCoord2);\n      commit('updatePolygon3', polygonCoord3);\n    }\n  },\n  namespaced: true\n};","map":{"version":3,"names":["axios","turf","mapCheckModule","state","deliveryPossible","polygonCoord1","polygonCoord2","polygonCoord3","mutations","setDeliveryPossible","updatePolygon1","updatePolygon2","updatePolygon3","actions","checkAddress","commit","console","log","lat","long","polygon1","polygon","polygon2","polygon3","points","pointsWithin1","pointsWithinPolygon","pointsWithin2","pointsWithin3","features","length","data","get","path","response","GeoObjectCollection","featureMember","GeoObject","metaDataProperty","GeocoderMetaData","filteredArray","Address","Components","filter","item","includes","kind","names","map","name","join","err","updatePolygonAction","namespaced"],"sources":["C:/gitPages/rol-shop/src/store/mapCheckModule.js"],"sourcesContent":["import axios from \"axios\";\r\nimport * as turf from \"@turf/turf\";\r\n\r\nexport const mapCheckModule = {\r\n  state: () => ({\r\n    deliveryPossible: false,\r\n    polygonCoord1: \"\",\r\n    polygonCoord2: \"\",\r\n    polygonCoord3: \"\",\r\n  }),\r\n  mutations: {\r\n    setDeliveryPossible(state, deliveryPossible) {\r\n      state.deliveryPossible = deliveryPossible;\r\n    },\r\n    updatePolygon1(state, polygonCoord1) {\r\n      state.polygonCoord1 = polygonCoord1;\r\n    },\r\n    updatePolygon2(state, polygonCoord2) {\r\n      state.polygonCoord2 = polygonCoord2;\r\n    },\r\n    updatePolygon3(state, polygonCoord3) {\r\n      state.polygonCoord3 = polygonCoord3;\r\n    }\r\n  },\r\n  actions: {\r\n    async checkAddress({ state, commit }) {\r\n      try {\r\n        console.log(polygonCoord1, polygonCoord2, polygonCoord3, lat, long)\r\n        var polygon1 = turf.polygon([polygonCoord1]);\r\n        var polygon2 = turf.polygon([polygonCoord2]);\r\n        var polygon3 = turf.polygon([polygonCoord3]);\r\n\r\n        // Создаем точки\r\n        var points = turf.points([[lat, long]]);\r\n\r\n        // Проверяем точки внутри полигона\r\n        var pointsWithin1 = turf.pointsWithinPolygon(points, polygon1);\r\n        var pointsWithin2 = turf.pointsWithinPolygon(points, polygon2);\r\n        var pointsWithin3 = turf.pointsWithinPolygon(points, polygon3);\r\n\r\n        if (pointsWithin1.features.length > 0 || pointsWithin2.features.length > 0) {\r\n          commit('setDeliveryPossible', true)\r\n        } else {\r\n          commit('setDeliveryPossible', false)   \r\n        }\r\n\r\n        const { data } = await axios.get(\r\n          `https://geocode-maps.yandex.ru/1.x/?apikey=37720b8b-dc03-4346-b6a4-3ae3458e9af6&geocode=${lat},${long}&format=json&lang=ru_RU`\r\n        );\r\n\r\n        const path =\r\n          data.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty\r\n            .GeocoderMetaData;\r\n        const filteredArray = path.Address.Components.filter((item) =>\r\n          [\r\n            \"street\",\r\n            \"metro\",\r\n            \"district\",\r\n            \"area\",\r\n            \"province\",\r\n            \"railway_station\",\r\n            \"station\",\r\n            \"vegetation\",\r\n            \"other\",\r\n            \"house\",\r\n          ].includes(item.kind)\r\n        );\r\n        const names = filteredArray.map((item) => item.name).join(\", \");\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    },\r\n    updatePolygonAction({commit}, polygonCoord1, polygonCoord2, polygonCoord3) {\r\n      commit('updatePolygon1', polygonCoord1);\r\n      commit('updatePolygon2', polygonCoord2);\r\n      commit('updatePolygon3', polygonCoord3);\r\n    }\r\n  },\r\n  namespaced: true\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}