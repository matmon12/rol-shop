{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { inject, computed } from \"vue\";\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      orderId: null,\n      isCreatingOrder: false,\n      cartIsEmpty: computed(() => this.cart.length === 0),\n      buttonDisabled: computed(() => this.isCreatingOrder || this.cartIsEmpty)\n    };\n  },\n  components: {},\n  props: {\n    totalPrice: Number\n  },\n  methods: {\n    async createOrder() {\n      try {\n        this.isCreatingOrder = true;\n        const {\n          data\n        } = await axios.post(`https://c2ff7a8de0a119c8.mokky.dev/orders`, {\n          items: this.cart,\n          totalPrice: this.totalPrice\n        });\n        this.cart = [];\n        this.orderId = data.id;\n\n        // история заказов в localStorage\n        this.historyOrder.push(this.orderId);\n        localStorage.setItem(\"order\", JSON.stringify(this.historyOrder));\n      } catch (err) {\n        console.log(err);\n      } finally {\n        this.isCreatingOrder = false;\n      }\n    },\n    async fetchOrder() {\n      try {\n        const {\n          data\n        } = await axios.get(`https://c2ff7a8de0a119c8.mokky.dev/orders?id=${this.historyOrder[this.historyOrder.length - 1]}`);\n        this.cart = data[0].items;\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    onRepeatOrder() {\n      this.fetchOrder().then(() => {\n        // включение кнопки для карточек и слайдера и favorites\n        this.sushi = this.updateItemsStatus(this.sushi);\n        this.rolls = this.updateItemsStatus(this.rolls);\n        this.sets = this.updateItemsStatus(this.sets);\n        this.snacks = this.updateItemsStatus(this.snacks);\n        this.drinks = this.updateItemsStatus(this.drinks);\n        this.slides = this.updateItemsStatus(this.slides);\n        this.favorites = this.updateItemsStatus(this.favorites);\n        this.categores = this.updateItemsStatus(this.categores);\n        this.slidesTovar = this.updateItemsStatus(this.slidesTovar);\n        this.cart.some(cartItem => cartItem.id === this.product.id) ? this.product.isAdded = true : null;\n      });\n    },\n    updateItemsStatus(items) {\n      return items.map(item => ({\n        ...item,\n        isAdded: this.cart.some(cartItem => cartItem.id === item.id)\n      }));\n    }\n  },\n  setup() {\n    const {\n      cart,\n      closeDrawer,\n      historyOrder\n    } = inject(\"cart\");\n    const {\n      sushi,\n      rolls,\n      sets,\n      snacks,\n      drinks,\n      slides,\n      favorites,\n      categores,\n      product,\n      slidesTovar\n    } = inject(\"items\");\n    return {\n      cart,\n      closeDrawer,\n      historyOrder,\n      sushi,\n      rolls,\n      sets,\n      snacks,\n      drinks,\n      slides,\n      favorites,\n      categores,\n      product,\n      slidesTovar\n    };\n  }\n};","map":{"version":3,"names":["inject","computed","axios","data","orderId","isCreatingOrder","cartIsEmpty","cart","length","buttonDisabled","components","props","totalPrice","Number","methods","createOrder","post","items","id","historyOrder","push","localStorage","setItem","JSON","stringify","err","console","log","fetchOrder","get","onRepeatOrder","then","sushi","updateItemsStatus","rolls","sets","snacks","drinks","slides","favorites","categores","slidesTovar","some","cartItem","product","isAdded","map","item","setup","closeDrawer"],"sources":["C:\\gitPages\\rol-shop\\src\\components\\Drawer.vue"],"sourcesContent":["<template>\r\n  <div class=\"basket\" @click.stop=\"closeDrawer\">\r\n    <div class=\"container\">\r\n      <div class=\"basket-wrapper\">\r\n        <div class=\"basket__inner\" @click.stop>\r\n          <div class=\"basket__head\">\r\n            <h3 class=\"basket__title\">Ваш заказ</h3>\r\n\r\n            <button @click=\"closeDrawer\" class=\"basket__close\">\r\n              <img src=\"@/img/icon/close.svg\" alt=\"close\" />\r\n            </button>\r\n          </div>\r\n\r\n          <div v-if=\"!totalPrice\" class=\"basket-info\">\r\n            <InfoBlock\r\n              title=\"В вашей корзине пока пусто\"\r\n              description=\"Тут появятся товары, которые вы закажите\"\r\n              button_1=\"Повторить прошлый заказ\"\r\n              button_2=\"История заказов\"\r\n              :img-url=\"require('@/img/icon/cart-empty.svg')\"\r\n              @repeat-order=\"onRepeatOrder\"\r\n            />\r\n          </div>\r\n\r\n          <div v-else class=\"basket-content\">\r\n            <CartList class=\"basket-list\" />\r\n\r\n            <p class=\"basket__limit\">Минимальная сумма заказа 400 грн</p>\r\n\r\n            <div class=\"basket__order\">\r\n              <div class=\"basket__sum\">\r\n                <p class=\"basket__sum-text\">Итого:</p>\r\n\r\n                <div class=\"basket__sum-price\">\r\n                  {{ totalPrice }}\r\n\r\n                  <span>грн</span>\r\n                </div>\r\n              </div>\r\n\r\n              <app-button\r\n                class=\"basket__order-btn\"\r\n                @click=\"$router.push('/rol-shop/order'), close\"\r\n                :disabled=\"buttonDisabled\"\r\n              >\r\n                Оформить заказ\r\n              </app-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { inject, computed } from \"vue\";\r\nimport axios from \"axios\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      orderId: null,\r\n      isCreatingOrder: false,\r\n      cartIsEmpty: computed(() => this.cart.length === 0),\r\n      buttonDisabled: computed(() => this.isCreatingOrder || this.cartIsEmpty),\r\n    };\r\n  },\r\n  components: {\r\n  },\r\n  props: {\r\n    totalPrice: Number,\r\n  },\r\n  methods: {\r\n    async createOrder() {\r\n      try {\r\n        this.isCreatingOrder = true;\r\n        const { data } = await axios.post(`https://c2ff7a8de0a119c8.mokky.dev/orders`, {\r\n          items: this.cart,\r\n          totalPrice: this.totalPrice,\r\n        });\r\n\r\n        this.cart = [];\r\n        this.orderId = data.id;\r\n\r\n        // история заказов в localStorage\r\n        this.historyOrder.push(this.orderId);\r\n        localStorage.setItem(\"order\", JSON.stringify(this.historyOrder));\r\n      } catch (err) {\r\n        console.log(err);\r\n      } finally {\r\n        this.isCreatingOrder = false;\r\n      }\r\n    },\r\n    async fetchOrder() {\r\n      try {\r\n        const { data } = await axios.get(\r\n          `https://c2ff7a8de0a119c8.mokky.dev/orders?id=${\r\n            this.historyOrder[this.historyOrder.length - 1]\r\n          }`\r\n        );\r\n\r\n        this.cart = data[0].items;\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    },\r\n    onRepeatOrder() {\r\n      this.fetchOrder().then(() => {\r\n        // включение кнопки для карточек и слайдера и favorites\r\n        this.sushi = this.updateItemsStatus(this.sushi);\r\n        this.rolls = this.updateItemsStatus(this.rolls);\r\n        this.sets = this.updateItemsStatus(this.sets);\r\n        this.snacks = this.updateItemsStatus(this.snacks);\r\n        this.drinks = this.updateItemsStatus(this.drinks);\r\n        this.slides = this.updateItemsStatus(this.slides);\r\n        this.favorites = this.updateItemsStatus(this.favorites);\r\n        this.categores = this.updateItemsStatus(this.categores);\r\n        this.slidesTovar = this.updateItemsStatus(this.slidesTovar);\r\n        this.cart.some((cartItem) => cartItem.id === this.product.id) ? this.product.isAdded = true : null;\r\n      });\r\n    },\r\n    updateItemsStatus(items) {\r\n      return items.map((item) => ({\r\n        ...item,\r\n        isAdded: this.cart.some((cartItem) => cartItem.id === item.id),\r\n      }));\r\n    },\r\n  },\r\n  setup() {\r\n    const { cart, closeDrawer, historyOrder } = inject(\"cart\");\r\n    const { sushi, rolls, sets, snacks, drinks, slides, favorites, categores, product, slidesTovar } = inject(\"items\");\r\n    return {\r\n      cart,\r\n      closeDrawer,\r\n      historyOrder,\r\n      sushi,\r\n      rolls,\r\n      sets,\r\n      snacks,\r\n      drinks,\r\n      slides,\r\n      favorites,\r\n      categores,\r\n      product,\r\n      slidesTovar\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.basket {\r\n  &-wrapper {\r\n    height: calc(100% - 10px);\r\n    display: flex;\r\n    justify-content: flex-end;\r\n  }\r\n  &__inner {\r\n    border-radius: $border;\r\n    background: #fff;\r\n    width: 590px;\r\n    overflow: hidden;\r\n    max-height: 718px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    position: relative;\r\n  }\r\n  &__head {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    margin-bottom: 24px;\r\n    padding: 30px 30px 0;\r\n  }\r\n  &__title {\r\n    color: $grey-dark;\r\n    font-size: 28px;\r\n    font-weight: 700;\r\n    line-height: 128%;\r\n  }\r\n  &__close {\r\n    align-self: start;\r\n    background: var(---, #f5f5f7);\r\n    border-radius: 8px;\r\n    width: 32px;\r\n    height: 32px;\r\n  }\r\n  &-list {\r\n    padding: 0 10px 0 30px;\r\n    margin-right: 20px;\r\n    overflow-y: auto;\r\n    scrollbar-color: #979797 transparent;\r\n    scrollbar-width: auto;\r\n    flex-grow: 1;\r\n    &::-webkit-scrollbar {\r\n      width: 5px;\r\n      color: #000;\r\n      background-color: transparent;\r\n    }\r\n    &::-webkit-scrollbar-thumb {\r\n      background-color: #d3d2d2;\r\n      border-radius: 5px;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n  &__limit {\r\n    color: #f63;\r\n    font-weight: 500;\r\n    padding: 32px 30px 12px;\r\n  }\r\n  &__order {\r\n    padding: 24px 30px;\r\n    background: #f5f5f7;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n  &__sum {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n  }\r\n  &__sum-text {\r\n    color: #9e9e9e;\r\n  }\r\n  &__sum-price {\r\n    color: $grey-dark;\r\n    font-size: 32px;\r\n    font-weight: 700;\r\n    line-height: 125%;\r\n    span {\r\n      color: #686870;\r\n      font-size: 21px;\r\n      margin-left: 0px;\r\n    }\r\n  }\r\n  &__order-btn {\r\n  }\r\n}\r\n\r\n.container {\r\n  height: 100%;\r\n}\r\n\r\n.basket-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  flex-grow: 1;\r\n  height: calc(100% - 90px);\r\n}\r\n\r\n.basket-info {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}