{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport { inject } from \"vue\";\nimport { mapState, mapActions } from \"vuex\";\nexport default {\n  data() {\n    return {\n      order: \"\",\n      count: 0,\n      isVisible: false,\n      products: [],\n      dialogVisible: false,\n      newMarker: [],\n      formattedDate: [],\n      error: false\n    };\n  },\n  methods: {\n    ...mapActions({\n      geocoderAddress: \"map/geocoderAddress\",\n      dateFormat: \"date/dateFormat\"\n    }),\n    async fetchOrder() {\n      let apiRes = null;\n      try {\n        const {\n          data\n        } = await axios.get(`https://c2ff7a8de0a119c8.mokky.dev/ordcers?number=${this.historyOrder}`);\n        this.order = data[0];\n      } catch (err) {\n        apiRes = err.response.status;\n      } finally {\n        if (apiRes == 404) {\n          this.error;\n          this.$router.push('/rol-shop/404');\n        }\n      }\n    },\n    geocoderCoord(lat, long) {},\n    creatingMarker() {\n      const fullAddres = `${this.order.address.city}, ${this.order.address.address}`;\n      this.geocoderAddress(fullAddres).then(() => {\n        this.newMarker = this.arrayCoord;\n      });\n    }\n  },\n  computed: {\n    ...mapState({\n      arrayCoord: state => state.map.arrayCoord\n    })\n  },\n  mounted() {\n    this.fetchOrder().then(() => {\n      if (!this.error) {\n        this.dateFormat({\n          dayDate: this.order.day,\n          yearDate: this.order.year,\n          timeDate: this.order.time\n        }).then(result => {\n          this.formattedDate = result;\n        });\n        this.order.items.forEach(element => {\n          this.count += element.count;\n        });\n        this.products = this.order.items;\n        if (this.order.freeProduct) {\n          this.order.freeProduct.forEach(item => this.products.push(item));\n          this.count += this.order.freeProduct.length;\n        }\n        this.creatingMarker();\n      }\n    });\n  },\n  setup() {\n    const {\n      historyOrder\n    } = inject(\"cart\");\n    return {\n      historyOrder\n    };\n  }\n};","map":{"version":3,"names":["axios","inject","mapState","mapActions","data","order","count","isVisible","products","dialogVisible","newMarker","formattedDate","error","methods","geocoderAddress","dateFormat","fetchOrder","apiRes","get","historyOrder","err","response","status","$router","push","geocoderCoord","lat","long","creatingMarker","fullAddres","address","city","then","arrayCoord","computed","state","map","mounted","dayDate","day","yearDate","year","timeDate","time","result","items","forEach","element","freeProduct","item","length","setup"],"sources":["C:\\gitPages\\rol-shop\\src\\pages\\OrderSuccess.vue"],"sourcesContent":["<template>\r\n  <div class=\"success\" >\r\n    <div class=\"container\">\r\n      <div class=\"success__inner\">\r\n        <div class=\"success__top\">\r\n          <div class=\"success__top-left\">\r\n            <p class=\"success__top-text\">\r\n              Спасибо,<br />\r\n              ваш заказ <span>{{ `#${order.number}` }}</span> успешно оформлен\r\n            </p>\r\n          </div>\r\n          <div class=\"success__top-right\">\r\n            <InfoDelivery\r\n              v-if=\"order\"\r\n              :address=\"order.address.address\"\r\n              :input=\"order.address.input\"\r\n              :apartment=\"order.address.apartment\"\r\n              :floor=\"order.address.floor\"\r\n              :formattedDate=\"formattedDate\"\r\n              :payment=\"order.payment\"\r\n              :totalPrice=\"order.totalPrice\"\r\n              :change=\"order.change\"\r\n              :regularSticks=\"order.regularSticks\"\r\n              :animals=\"order.animals\"\r\n              :options=\"order.options\"\r\n              :note=\"order.note\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"success__bottom\">\r\n          <el-collapse @change=\"isVisible = !isVisible\">\r\n            <el-collapse-item>\r\n              <template #title>\r\n                <div class=\"success__bottom-top\">\r\n                  <InfoOrder\r\n                    :isVisible=\"isVisible\"\r\n                    :formattedDate=\"formattedDate\"\r\n                    :number=\"order.number\"\r\n                    :items=\"products\"\r\n                    :totalPrice=\"order.totalPrice\"\r\n                    :year=\"order.year\"\r\n                    :count=\"count\"\r\n                  />\r\n                </div>\r\n                <div class=\"success__bottom-bottom\">\r\n                  <StepsOrder :methods=\"order.methods\" :steps=\"0\" />\r\n                </div>\r\n              </template>\r\n              <div class=\"success__products-wrapper\">\r\n                <ListOrders :products=\"products\" />\r\n              </div>\r\n            </el-collapse-item>\r\n          </el-collapse>\r\n        </div>\r\n        <div class=\"success__btn-wrapper\">\r\n          <button\r\n            v-if=\"order.methods === 'Самовывоз'\"\r\n            @click=\"dialogVisible = true\"\r\n            class=\"success__btn-direction\"\r\n          >\r\n            Проложить маршрут\r\n          </button>\r\n          <button class=\"success__btn\" @click=\"$router.push('/rol-shop/')\">\r\n            Вернутся на главную\r\n          </button>\r\n        </div>\r\n        <el-dialog v-model=\"dialogVisible\" title=\"Построение маршрута\" align-center>\r\n          <p class=\"success__dialog-text\">\r\n            Здесь вы можете просмотреть маршрут в точку выдачи\r\n          </p>\r\n          <div class=\"success__map\">\r\n            <Map :geocoderCoord=\"geocoderCoord\" :newMarker=\"newMarker\" ref=\"Map\" />\r\n          </div>\r\n        </el-dialog>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport { inject } from \"vue\";\r\nimport { mapState, mapActions } from \"vuex\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      order: \"\",\r\n      count: 0,\r\n      isVisible: false,\r\n      products: [],\r\n      dialogVisible: false,\r\n      newMarker: [],\r\n      formattedDate: [],\r\n      error: false\r\n    };\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      geocoderAddress: \"map/geocoderAddress\",\r\n      dateFormat: \"date/dateFormat\",\r\n    }),\r\n    async fetchOrder() {\r\n      let apiRes = null;\r\n      try {\r\n        const { data } = await axios.get(\r\n          `https://c2ff7a8de0a119c8.mokky.dev/ordcers?number=${this.historyOrder}`\r\n        );\r\n        this.order = data[0];\r\n      } catch (err) {\r\n        apiRes = err.response.status;\r\n      } finally {\r\n        if (apiRes == 404) {\r\n          this.error\r\n          this.$router.push('/rol-shop/404');\r\n        }\r\n      }\r\n    },\r\n    geocoderCoord(lat, long) {},\r\n    creatingMarker() {\r\n      const fullAddres = `${this.order.address.city}, ${this.order.address.address}`;\r\n      this.geocoderAddress(fullAddres).then(() => {\r\n        this.newMarker = this.arrayCoord;\r\n      });\r\n    },\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      arrayCoord: (state) => state.map.arrayCoord,\r\n    }),\r\n  },\r\n  mounted() {\r\n    this.fetchOrder().then(() => {\r\n      if(!this.error) {\r\n        this.dateFormat({\r\n          dayDate: this.order.day,\r\n          yearDate: this.order.year,\r\n          timeDate: this.order.time,\r\n        }).then((result) => {\r\n          this.formattedDate = result;\r\n        });\r\n        this.order.items.forEach((element) => {\r\n          this.count += element.count;\r\n        });\r\n        this.products = this.order.items;\r\n        if (this.order.freeProduct) {\r\n          this.order.freeProduct.forEach((item) => this.products.push(item));\r\n          this.count += this.order.freeProduct.length;\r\n        }\r\n        this.creatingMarker();\r\n      }\r\n    });\r\n  },\r\n  setup() {\r\n    const { historyOrder } = inject(\"cart\");\r\n    return {\r\n      historyOrder,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.success {\r\n  margin-bottom: 64px;\r\n  &__inner {\r\n  }\r\n\r\n  &__map {\r\n    width: 100%;\r\n    height: 500px;\r\n    border-radius: $border;\r\n    overflow: hidden;\r\n  }\r\n\r\n  &__top {\r\n    margin-bottom: 16px;\r\n    border-radius: $border;\r\n    background-color: #fff;\r\n    padding: 48px 64px 16px;\r\n    display: flex;\r\n    gap: 138px;\r\n  }\r\n\r\n  &__top-left {\r\n    max-width: 340px;\r\n  }\r\n\r\n  &__top-text {\r\n    color: $grey-dark;\r\n    font-size: 34px;\r\n    font-weight: 700;\r\n    line-height: 1.4;\r\n    span {\r\n      color: #fff;\r\n      background-color: rgb(255, 102, 51);\r\n      padding: 4px 8px;\r\n      border-radius: $border;\r\n    }\r\n  }\r\n\r\n  &__top-right {\r\n    flex-grow: 1;\r\n  }\r\n\r\n  &__bottom {\r\n    border-radius: $border;\r\n    background-color: #fff;\r\n    padding: 24px 0;\r\n  }\r\n\r\n  &__bottom-top {\r\n    padding: 12px 48px;\r\n    margin-bottom: 12px;\r\n  }\r\n\r\n  &__bottom-bottom {\r\n    padding: 0 16px;\r\n  }\r\n  &__products-wrapper {\r\n    padding-top: 34px;\r\n  }\r\n\r\n  &__btn {\r\n    border-radius: $border;\r\n    background-color: #fff;\r\n    padding: 16px 24px;\r\n    width: 265px;\r\n    color: rgb(0, 204, 45);\r\n    font-size: 16px;\r\n    font-weight: 500;\r\n    line-height: 1.5;\r\n    &-wrapper {\r\n      margin-top: 24px;\r\n      display: flex;\r\n      justify-content: center;\r\n      gap: 16px;\r\n    }\r\n    &-direction {\r\n      border-radius: $border;\r\n      padding: 16px 24px;\r\n      background-color: rgb(0, 204, 45);\r\n      color: #fff;\r\n      width: 256px;\r\n      font-size: 16px;\r\n      font-weight: 500;\r\n      line-height: 1.5;\r\n    }\r\n  }\r\n\r\n  &__dialog-text {\r\n    font-weight: 400;\r\n    color: rgb(104, 104, 112);\r\n    margin-bottom: 20px;\r\n  }\r\n}\r\n</style>\r\n<style lang=\"scss\">\r\n.el-collapse {\r\n  border-top: none;\r\n  border-bottom: none;\r\n}\r\n.el-collapse-item__header {\r\n  display: block;\r\n  height: auto;\r\n  line-height: inherit;\r\n  background-color: transparent;\r\n  color: transparent;\r\n  cursor: pointer;\r\n  border-bottom: none;\r\n  font-size: inherit;\r\n  font-weight: 400;\r\n  transition: border-bottom-color var(--el-transition-duration);\r\n  outline: 0;\r\n}\r\n.el-collapse-item__arrow {\r\n  display: none;\r\n}\r\n.el-collapse-item__wrap {\r\n  background-color: transparent;\r\n  border-bottom: none;\r\n}\r\n.el-collapse-item__content {\r\n  padding-bottom: 0;\r\n  font-size: inherit;\r\n  color: transparent;\r\n  line-height: inherit;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}